---
import "../styles/global.css";
import MainMenu from "src/components/MainMenu.svelte";
import GlobalLanguageSelector from "src/components/GlobalLanguageSelector.svelte";
import ErrorBoundary from "src/components/ErrorBoundary.svelte";
import { getLangFromUrl, useTranslations } from "src/i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Pre-compute all translations needed by MainMenu
const translations = {
  'main.title': t('main.title'),
  'main.subtitle': t('main.subtitle'),
  'main.description': t('main.description'),
  'main.solar': t('main.solar'),
  'main.explore': t('main.explore'),
  'main.galaxy': t('main.galaxy'),
  'main.settings': t('main.settings'),
  'constellation.title': t('constellation.title'),
  'aria.startGame': t('aria.startGame'),
  'aria.systems': t('aria.systems'),
  'aria.galaxy': t('aria.galaxy'),
  'aria.constellation': t('aria.constellation'),
  'aria.settings': t('aria.settings'),
  'instructions.mouse': t('instructions.mouse'),
  'instructions.scroll': t('instructions.scroll'),
  'instructions.click': t('instructions.click'),
  'instructions.keyboard': t('instructions.keyboard'),
  'instructions.enter': t('instructions.enter'),
  'systems.title': t('systems.title'),
  'systems.system': t('systems.system'),
  'action.cancel': t('action.cancel'),
  'aria.close': t('aria.close'),
  'sr.mainMenuLoaded': t('sr.mainMenuLoaded')
};
---

<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{t('page.title')}</title>
    <meta name="description" content={t('page.description')} />
  </head>

  <body>
    <!-- Global Language Selector -->
    <GlobalLanguageSelector client:only="svelte" />
    
    <ErrorBoundary client:idle>
      <MainMenu lang={lang} translations={translations} client:idle />
    </ErrorBoundary>
  </body>
</html>
